{
  "models": {
    "small": {
      "vocab_size": 32016,
      "hidden_size": 256,
      "num_layers": 4,
      "num_heads": 4,
      "num_kv_heads": 1,
      "use_rms_norm": true,
      "use_swiglu": true,
      "max_position_embeddings": 512,
      "dropout": 0.1,
      "attention_dropout": 0.1,
      "layer_norm_eps": 1e-5,
      "initializer_range": 0.02,
      "use_cache": true
    },
    "medium": {
      "vocab_size": 32016,
      "hidden_size": 768,
      "num_layers": 12,
      "num_heads": 12,
      "num_kv_heads": 1,
      "use_rms_norm": true,
      "use_swiglu": true,
      "max_position_embeddings": 512,
      "dropout": 0.1,
      "attention_dropout": 0.1,
      "layer_norm_eps": 1e-5,
      "initializer_range": 0.02,
      "use_cache": true
    }
  },
  
  "default_model_size": "medium",
  
  "rope": {
    "theta": 10000.0,
    "scaling_type": "linear",
    "scaling_factor": 1.0
  },
  
  "tokenizer": {
    "bos_token_id": 1,
    "eos_token_id": 2,
    "unk_token_id": 0,
    "pad_token_id": 2
  },
  
  "training": {
    "batch_size": 32,
    "gradient_accumulation_steps": 16,
    "max_steps": 50000,
    "learning_rate": 0.001,
    "min_learning_rate": 0.0001,
    "warmup_ratio": 0.02,
    "cosine_target_ratio": 0.8,
    "weight_decay": 0.1,
    "max_grad_norm": 1.0
  },
  
  "logging": {
    "eval_steps": 500,
    "save_steps": 1000,
    "logging_steps": 10
  },
  
  "dataset": {
    "source": "fineweb",
    "wikipedia_test_dir": "/home/andrea/Desktop/data/tokenized_datasets/codellama_test_dataset",
    "wikipedia_full_dir": "/home/andrea/Desktop/data/tokenized_datasets/codellama_full_dataset",
    "fineweb_test_dir": "/home/andrea/Desktop/data/tokenized_datasets/fineweb_test_dataset",
    "fineweb_full_dir": "/home/andrea/Desktop/data/tokenized_datasets/fineweb_full_dataset"
  },
  
  "paths": {
    "checkpoint_dir": "checkpoints",
    "log_dir": "logs",
    "tokenizer_dir": "tokenizers/codellama_tokenizer",
    "dataset_dir": "/home/andrea/Desktop/data/tokenized_datasets/fineweb_full_dataset"
  },
  
  "pytorch_backend": {
    "allow_tf32": true,
    "matmul_precision": "medium"
  }
}
